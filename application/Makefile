WAYLAND_PROTOCOLS_UNSTABLE_DIR=/usr/share/wayland-protocols/unstable
WAYLAND_PROTOCOLS_UNSTABLE_TARGET_DIR=wayland-protocols/unstable
WAYLAND_PROTOCOLS_TARGET_DIR=wayland-protocols

XDG_SHELL_HEADER=xdg-shell.h
XDG_SHELL_SOURCE=xdg-shell.c
XDG_SHELL_HEADER_PATH=$(WAYLAND_PROTOCOLS_UNSTABLE_TARGET_DIR)/$(XDG_SHELL_HEADER)
XDG_SHELL_SOURCE_PATH=$(WAYLAND_PROTOCOLS_UNSTABLE_TARGET_DIR)/$(XDG_SHELL_SOURCE)

C_INCLUDES := -I./$(WAYLAND_PROTOCOLS_TARGET_DIR)

default: $(XDG_SHELL_HEADER_PATH) $(XDG_SHELL_SOURCE_PATH)
	gcc $(C_INCLUDES) -lwayland-client -lwayland-egl -lwayland-cursor -lEGL -lGLESv2 main.c utils.c application.c window.c $(XDG_SHELL_SOURCE_PATH)

$(XDG_SHELL_HEADER_PATH):
	wayland-scanner client-header $(WAYLAND_PROTOCOLS_UNSTABLE_DIR)/xdg-shell/xdg-shell-unstable-v6.xml $(WAYLAND_PROTOCOLS_UNSTABLE_TARGET_DIR)/$(XDG_SHELL_HEADER)

$(XDG_SHELL_SOURCE_PATH):
	wayland-scanner public-code $(WAYLAND_PROTOCOLS_UNSTABLE_DIR)/xdg-shell/xdg-shell-unstable-v6.xml $(WAYLAND_PROTOCOLS_UNSTABLE_TARGET_DIR)/$(XDG_SHELL_SOURCE)

